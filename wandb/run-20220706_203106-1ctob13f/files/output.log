
[34m[1mwandb[39m[22m: [33mWARNING[39m The save_model argument by default saves the model in the HDF5 format that cannot save custom objects like subclassed models and custom layers. This behavior will be deprecated in a future release in favor of the SavedModel format. Meanwhile, the HDF5 model is saved as W&B files and the SavedModel as W&B Artifacts.
WARNING:tensorflow:Issue encountered when serializing table_initializer.
Type is unsupported, or the types of the items don't match field type in CollectionDef. Note this is a warning and probably safe to ignore.
'NoneType' object has no attribute 'name'
2022-07-06 20:31:18.524572: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:961] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2022-07-06 20:31:18.524911: I tensorflow/core/grappler/devices.cc:66] Number of eligible GPUs (core count >= 8, compute capability >= 0.0): 1
2022-07-06 20:31:18.525658: I tensorflow/core/grappler/clusters/single_machine.cc:358] Starting new session
2022-07-06 20:31:18.527652: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:961] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
WARNING:tensorflow:From /home/jpao/miniconda3/envs/tf-py39/lib/python3.9/site-packages/tensorflow/python/profiler/internal/flops_registry.py:138: tensor_shape_from_node_def_name (from tensorflow.python.framework.graph_util_impl) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.compat.v1.graph_util.tensor_shape_from_node_def_name`
Epoch 1/5
2022-07-06 20:31:18.528327: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:961] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2022-07-06 20:31:18.529062: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:961] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2022-07-06 20:31:18.530276: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:961] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2022-07-06 20:31:18.530345: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1616] Could not identify NUMA node of platform GPU id 0, defaulting to 0.  Your kernel may not have been built with NUMA support.
2022-07-06 20:31:18.531571: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:961] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2022-07-06 20:31:18.531676: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 4598 MB memory:  -> device: 0, name: NVIDIA GeForce GTX 1060, pci bus id: 0000:01:00.0, compute capability: 6.1
2022-07-06 20:31:21.576988: I tensorflow/stream_executor/cuda/cuda_dnn.cc:384] Loaded cuDNN version 8401






















































































1419/1419 [==============================] - ETA: 0s - loss: 0.0747 - accuracy: 0.9842
[34m[1mwandb[39m[22m: [32m[41mERROR[39m[49m Can't save model in the h5py format. The model will be saved as W&B Artifacts in the SavedModel format.
WARNING:absl:Found untraced functions such as adapt_step, _jit_compiled_convolution_op while saving (showing 2 of 2). These functions will not be directly callable after loading.
INFO:tensorflow:Assets written to: /home/jpao/ColorSkim/wandb/run-20220706_203106-1ctob13f/files/model-best/assets
1419/1419 [==============================] - ETA: 0s - loss: 0.0747 - accuracy: 0.9842INFO:tensorflow:Assets written to: /home/jpao/ColorSkim/wandb/run-20220706_203106-1ctob13f/files/model-best/assets
1419/1419 [==============================] - 206s 141ms/step - loss: 0.0747 - accuracy: 0.9842 - val_loss: 0.0263 - val_accuracy: 0.9934 - _timestamp: 1657114479.0000 - _runtime: 213.0000
Epoch 2/5



































































































1419/1419 [==============================] - ETA: 0s - loss: 0.0176 - accuracy: 0.9953
WARNING:absl:Found untraced functions such as adapt_step, _jit_compiled_convolution_op while saving (showing 2 of 2). These functions will not be directly callable after loading.
INFO:tensorflow:Assets written to: /home/jpao/ColorSkim/wandb/run-20220706_203106-1ctob13f/files/model-best/assets
1419/1419 [==============================] - ETA: 0s - loss: 0.0176 - accuracy: 0.9953INFO:tensorflow:Assets written to: /home/jpao/ColorSkim/wandb/run-20220706_203106-1ctob13f/files/model-best/assets
1419/1419 [==============================] - 220s 155ms/step - loss: 0.0176 - accuracy: 0.9953 - val_loss: 0.0262 - val_accuracy: 0.9931 - _timestamp: 1657114700.0000 - _runtime: 434.0000
Epoch 3/5
































































































1419/1419 [==============================] - ETA: 0s - loss: 0.0157 - accuracy: 0.9957
WARNING:absl:Found untraced functions such as adapt_step, _jit_compiled_convolution_op while saving (showing 2 of 2). These functions will not be directly callable after loading.
INFO:tensorflow:Assets written to: /home/jpao/ColorSkim/wandb/run-20220706_203106-1ctob13f/files/model-best/assets
1419/1419 [==============================] - ETA: 0s - loss: 0.0157 - accuracy: 0.9957INFO:tensorflow:Assets written to: /home/jpao/ColorSkim/wandb/run-20220706_203106-1ctob13f/files/model-best/assets
1419/1419 [==============================] - 216s 152ms/step - loss: 0.0157 - accuracy: 0.9957 - val_loss: 0.0261 - val_accuracy: 0.9936 - _timestamp: 1657114916.0000 - _runtime: 650.0000
Epoch 4/5
























































































1419/1419 [==============================] - 191s 135ms/step - loss: 0.0149 - accuracy: 0.9959 - val_loss: 0.0263 - val_accuracy: 0.9937 - _timestamp: 1657115111.0000 - _runtime: 845.0000
Epoch 5/5































































































1419/1419 [==============================] - 206s 145ms/step - loss: 0.0144 - accuracy: 0.9960 - val_loss: 0.0267 - val_accuracy: 0.9937 - _timestamp: 1657115317.0000 - _runtime: 1051.0000
1/1 [==============================] - 0s 199ms/step










355/355 [==============================] - 20s 56ms/step - loss: 0.0267 - accuracy: 0.9937






355/355 [==============================] - 13s 35ms/step
Kata acak:
 TANK
Kata setelah embed dengan USE:
[-0.05306419  0.01829822  0.04102655  0.05301484 -0.01183148  0.0386189
  0.00015242  0.00415491  0.00867626  0.04968305  0.04793388  0.0794832
  0.00084024 -0.04098772  0.0196521   0.03149984  0.064807    0.08047114
 -0.0696092  -0.00560834  0.01252672  0.00304709 -0.00837936 -0.08412522
  0.01018614  0.0278815   0.00761966 -0.02709839  0.05106845  0.02898341]
Panjang dari kata setelah embedding: 512
Model: "model_2_Conv1D_USE_embed"
_________________________________________________________________
 Layer (type)                Output Shape              Param #
=================================================================
 layer_input (InputLayer)    [(None,)]                 0
 universal_sentence_encoder   (None, 512)              256797824
 (KerasLayer)
 tf.expand_dims (TFOpLambda)  (None, 512, 1)           0
 conv1d (Conv1D)             (None, 512, 64)           384
 layer_max_pooling (GlobalMa  (None, 64)               0
 xPooling1D)
 layer_output (Dense)        (None, 1)                 65
=================================================================
Total params: 256,798,273
Trainable params: 449
Non-trainable params: 256,797,824
_________________________________________________________________